angular.module("newborn",["ui.bootstrap"]),angular.module("newborn").controller("mainCtrl",["$scope","assessmentService",function(a,b){a.assessmentLabels=b.assessments,a.assessment=_(a.assessmentLabels).pluck("type").map(function(a,b){return{type:a,score:0,selectedOption:b+"_0_0"}}).value(),a.totalScore=0,a.getScoreClass=function(a){return 0===a?"success":1===a?"warning":"danger"},a.getRecommendationClass=function(a){return 3===a?"danger":2===a?"primary":1===a?"info":"success"},a.$watch("assessment",function(c){a.recommendations=b.getRecommendations(c),a.transporting=b.getTransportingInfo(c),a.totalScore=b.getAssessmentScore(c);var d=b.states[a.totalScore]||b.states[0];a.totalClass=d.className,a.totalState=d.state},!0)}]),angular.module("newborn").factory("assessmentService",function(){function a(a){return _.pluck(a,"score").reduce(function(a,b){return a+b},0)}var b=[{type:"Центральная нервная система",labels:[[{text:"Норма",recommendation:""}],[{text:"Мышечная гипотония",recommendation:"Патогенетическое лечение"},{text:"Гиподинамия",recommendation:"Патогенетическое лечение"},{text:"Гипорефлексия",recommendation:"Патогенетическое лечение"},{text:"Вялая реакция на осмотр",recommendation:"Патогенетическое лечение"}],[{text:"Отсутствие сознания",recommendation:"Патогенетическое лечение"},{text:"Мышечная атония",recommendation:"Патогенетическое лечение"},{text:"Адинамия",recommendation:"Патогенетическое лечение"},{text:"Арефлексия",recommendation:"Патогенетическое лечение"}]]},{type:"Дыхание",labels:[[{text:"Норма",recommendation:""}],[{text:"Нуждается в кислороде через кислородную маску",recommendation:"Поставить кислородную маску"},{text:"Нуждается в кислороде через носовой катетер",recommendation:"Поставить носовой катетер"}],[{text:"Нуждается в ИВЛ",recommendation:"Подобрать параметры ИВЛ"},{text:"Находится на спонтанном дыхании с повышенным давлением на выдохе через носовые канюли",recommendation:"Подобрать параметры CPAP"},{text:"Находится на спонтанном дыхании с повышенным давлением на выдохе через интубационную трубку",recommendation:"Подобрать параметры CPAP"}]]},{type:"Сердечно-сосудистая система",labels:[[{text:"Норма",recommendation:""}],[{text:"Умеренная тахикардия (160-170 уд./мин.)",recommendation:"Расширить диагностическую программу"}],[{text:"Выраженная брадикардия (<100 уд./мин.)",recommendation:"СРОЧНО: реанимационные мероприятия"},{text:"Выраженная тахикардия (>170 уд./мин.)",recommendation:"Расширить диагностическую программу"},{text:"Артериальная гипотония",recommendation:"Ввести аутератоники (допамин)"}]]},{type:"Печень",labels:[[{text:"Норма",recommendation:""}],[{text:"Увеличена менее чем на 2 см",recommendation:"Патогенетическое лечение"}],[{text:"Увеличена более чем на 2 см",recommendation:"Патогенетическое лечение"}]]},{type:"Мочевыделительная система",labels:[[{text:"Норма",recommendation:""}],[{text:"Олигоурия",recommendation:"Нормализовать АД"}],[{text:"Анурия",recommendation:"Инфузионная терапия для восстановления АД; улучшить почечный кровоток"},{text:"Гематурия",recommendation:"Инфузионная терапия; антибактериальная терапия"}]]},{type:"Кожа",labels:[[{text:"Норма",recommendation:""}],[{text:"Умеренная бледность с периоральным и акроцианозом",recommendation:"Наладить адекватную оксигенацию"}],[{text:"Выраженная желтуха",recommendation:"Поставить лампу фототерапии"},{text:"Выраженная бледность",recommendation:"Инфузионная терапия для восстановления ОЦК"},{text:"Цианоз",recommendation:"Наладить адекватную оксигенацию"},{text:"Кровоизлияния диапедезного характера",recommendation:"Инфузионная терапия"}]]},{type:"Температура тела",labels:[[{text:"Норма (36,5 — 37,2°C)",recommendation:""}],[{text:"Умеренная гипотермия (36,0 — 36,4°C)",recommendation:"Положить в кювез; довести температуру до 36,5°C"}],[{text:"Гипертермия (>37,2°C)",recommendation:"Выключить кювез, открыть окошко; При t > 38°C - поставить жаропонижающие свечи"},{text:"Выраженная гипотермия (<36,0°C)",recommendation:"Установить температуру в кювезе на 38,5°C"}]]}],c=[{state:"Нормальное",className:"success"},{state:"Среднетяжелое",className:"info"},{state:"Среднетяжелое",className:"info"},{state:"Тяжелое",className:"primary"},{state:"Тяжелое",className:"primary"},{state:"Тяжелое",className:"primary"},{state:"Очень тяжелое",className:"warning"},{state:"Очень тяжелое",className:"warning"},{state:"Очень тяжелое",className:"warning"},{state:"Очень тяжелое",className:"warning"},{state:"Крайне тяжелое",className:"danger"},{state:"Крайне тяжелое",className:"danger"},{state:"Крайне тяжелое",className:"danger"},{state:"Крайне тяжелое",className:"danger"},{state:"Крайне тяжелое",className:"danger"}];return{assessments:b,states:c,getAssessmentScore:a,getRecommendations:function(a){var c=_(a).map(function(a){var c=a.selectedOption.split("_"),d=c[0],e=c[1],f=c[2];return{text:b[d].labels[e][f].recommendation,type:b[d].type,level:parseInt(e)}}).filter(function(a){return""!==a.text}).value();return c},getTransportingInfo:function(b){var c=a(b);return c>8?{level:2,text:"Транспортировка невозможна, снизить оценку до 8 баллов"}:c>2?{level:1,text:"Транспортировка возможна"}:c>0?{level:0,text:"Транспортировка не требуется"}:{}}}});