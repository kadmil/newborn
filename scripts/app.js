angular.module("newborn",["ui.bootstrap"]);angular.module("newborn").controller("mainCtrl",["$scope",function($scope){$scope.assesment=[{type:"Центральная нервная система",labels:[[{text:"Норма",id:0}],[{text:"Мышечная гипотония",id:0},{text:"Гиподинамия",id:1},{text:"Гипорефлексия",id:2},{text:"Вялая реакция на осмотр",id:3}],[{text:"Отсутствие сознания",id:0},{text:"Мышечная атония",id:1},{text:"Адинамия",id:2},{text:"Арефлексия",id:3}]],score:0,labelId:"0_0"},{type:"Дыхание",labels:[[{text:"Норма",id:0}],[{text:"Нуждается в кислороде через кислородную маску",id:0},{text:"Нуждается в кислороде через носовой катетер",id:1}],[{text:"Нуждается в ИВЛ",id:0},{text:"Находится на спонтанном дыхании с повышенным давлением на выдохе через носовые канюли",id:1},{text:"Находится на спонтанном дыхании с повышенным давлением на выдохе через интубационную трубку",id:2}]],score:0,labelId:"0_0"},{type:"Сердечно-сосудистая система",labels:[[{text:"Норма",id:0}],[{text:"Умеренная тахикардия (160-170 уд./мин.)",id:0}],[{text:"Выраженная брадикардия (<100 уд./мин.)",id:0},{text:"Выраженная тахикардия (>170 уд./мин.)",id:1},{text:"Артериальная гипотония",id:2}]],score:0,labelId:"0_0"},{type:"Печень",labels:[[{text:"Норма",id:0}],[{text:"Увеличена менее чем на 2 см",id:0}],[{text:"Увеличена более чем на 2 см",id:0}]],score:0,labelId:"0_0"},{type:"Мочевыделительная система",labels:[[{text:"Норма",id:0}],[{text:"Олигоурия",id:0}],[{text:"Анурия",id:0},{text:"Гематурия",id:1}]],score:0,labelId:"0_0"},{type:"Кожа",labels:[[{text:"Норма",id:0}],[{text:"Умеренная бледность с периоральным и акроцианозом",id:0}],[{text:"Выраженная желтуха",id:0},{text:"Выраженная бледность",id:1},{text:"Цианоз",id:2},{text:"Кровоизлияния диапедезного характера",id:3}]],score:0,labelId:"0_0"},{type:"Температура тела",labels:[[{text:"Норма (36,5 — 37,2°C)",id:0}],[{text:"Умеренная гипотермия (36,0 — 36,4°C)",id:0}],[{text:"Гипертермия (>37,2°C)",id:0},{text:"Выраженная гипотермия (<36,0°C)",id:1}]],score:0,labelId:"0_0"}];$scope.assesment.getTotalScore=function(){return _.pluck($scope.assesment,"score").reduce(function(res,score){return res+score},0)};$scope.totalScore=0;$scope.getOptionClass=function(optionScore){return optionScore===0?"label-success":optionScore===1?"label-warning":"label-danger"};var states=[{state:"Нормальное",className:"label-success"},{state:"Среднетяжелое",className:"label-info"},{state:"Среднетяжелое",className:"label-info"},{state:"Тяжелое",className:"label-primary"},{state:"Тяжелое",className:"label-primary"},{state:"Тяжелое",className:"label-primary"},{state:"Очень тяжелое",className:"label-warning"},{state:"Очень тяжелое",className:"label-warning"},{state:"Очень тяжелое",className:"label-warning"},{state:"Очень тяжелое",className:"label-warning"},{state:"Крайне тяжелое",className:"label-danger"},{state:"Крайне тяжелое",className:"label-danger"},{state:"Крайне тяжелое",className:"label-danger"},{state:"Крайне тяжелое",className:"label-danger"},{state:"Крайне тяжелое",className:"label-danger"}];$scope.$watch(function(){return $scope.assesment.getTotalScore()},function(newVal){$scope.totalScore=newVal;var state=states[$scope.totalScore]||states[0];$scope.totalClass=state.className;$scope.totalState=state.state})}]);